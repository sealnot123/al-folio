<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head><!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>My Awesome Title | YNAB SpreadSheet</title>
    <meta name="author" content="Tanapoom  Laoaron" />
    <meta name="description" content="Mimic simple YNAB's features on Google Spreadsheet" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&amp;display=swap" rel="stylesheet">
    
    
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+JP">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Maitree">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu+Mono">
    
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tangerine">
    

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://sealnot123.github.io/projects/7_YNAB_Spreadsheet/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://sealnot123.github.io/">My Awesome Title</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item ">
                <a class="nav-link" href="/blog/">Blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Projects</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">YNAB SpreadSheet</h1>
            <p class="post-description">Mimic simple YNAB's features on Google Spreadsheet</p>
          </header>

          <article>
            <center>
<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/Project7_intro-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/Project7_intro-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/Project7_intro-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/Project7_intro.jpg" title="YNAB Spreadsheet">

  </picture>

</figure>

    </div>
</div>
</center>

<h2 id="inspiration">Inspiration</h2>

<p>I came to the US in late August. 
I live in an off-campus dorm (my monthly income couldn’t afford the on-campus dorm).
I have to manage my money myself, unlike at home where my mom and my dad manage finance for the family.
I learn from both my friends and my seniors that a Thai scholar’s monthly income is barely enough to survive a month.</p>

<p>About a year ago, I saw Phoom’s post about the finance management app called <a href="https://www.youneedabudget.com/" target="_blank" rel="noopener noreferrer">YNAB (You Need A Budget)</a>. 
I saw he said it’s a good app, so I decided to give it a try.
After I use its free-trial for a month:
It really helps me become more aware of my own budget.
Even though I used a bit more money than my monthly income, I really am satisfied with the result. (I believe I would’ve used a lot more money if I didn’t keep track of my spending)</p>

<p>I would like to continue the subscription, but my monthly income is very scarce.
I had been thinking that I might be able to create a google spreadsheet that mimics the app’s functions.
I barely have any experiences on MS-Excel or Google Spreadsheet; I know only few things like using an equal sign to trigger mathematical functions, or knowing what does clicking and dragging the bottom right of any cell do.
I also don’t know much how to write scripts; the most prestige scripts I wrote is a shell-script for checking the correctness of my C++ program in a programming contest.
Despite all that, after the free-trial expires, I decided to give it a try.</p>

<h2 id="implementation">Implementation</h2>

<p>In YNAB app, my monthly spendings are divided into categories, such as “Groceries”, “Laundry”, “Education”, “Internet &amp; Fee”, “Dining Out”, “Fun Money”, etc.</p>

<p>For each category, I have to assign my current money into it, and those money will be the money I can spend on that category in this month.</p>

<p>For example, if I assign $150 to “Groceries”, that means I place $150 of my monthly income for groceries, and I can only spend $150 on groceries in this month.</p>

<p>I started by create a spreadsheet with one sheet, with each cell of the first column (column A) contains a name of one of the categories.
Next, to keep track my spendings in each category, I need to create a sheet for each category.</p>

<p>In a sheet, I will keep track the information of each of my spending in that category, such as “Amount”, “Payee”, “Date”, and “Description”.
I assign the first 4 columns for each piece of information respectively.
For example, if I went to MOOYAH (an american hamburger restaurant) and brought a cheeseburger with $15.25, then the information I will enter in each column will be (Amount)”15.25”, (Payee)”MOOYAH”, (Date)”10/15/2021”, and (Description)”Double Cheeseburger”.
Each row in the sheet will be an information for each spending.
Therefore, I create a template sheet with the specification.</p>
<h3 id="the-first-problem">The First Problem</h3>
<p>The problem is, I need to do that for all 17 (SEVENTEEN) categories.</p>

<p>Having to do</p>
<ol>
  <li>Right Click on the template sheet</li>
  <li>Click “Duplicate”</li>
  <li>Right-Click on the duplicated sheet</li>
  <li>Click “Rename”</li>
  <li>Type the name of a category</li>
  <li>Press Enter</li>
  <li>Go Back to Main Sheet</li>
</ol>

<p>17 times over and over would be an eternal pain.
So I decided to take a step back and think of what I need to do.</p>

<p>Everything boils down to the following problem description:</p>
<blockquote>
You are given a spreadsheet. In the spreadsheet, there are two sheets. In the first sheet, each cell in the first column (column A) contains a name. The second sheet is a template sheet. Create a new sheet for each of the cell in the first column of the first sheet, where the name of the sheet is the name in the cell, and the information in the sheet is the same as the information in the template sheet (the second sheet)."
</blockquote>
<blockquote>
[Thai version] "ใน spreadsheet อันหนึ่ง มี sheet นึง โดยแต่ละเซลล์ในคอลัมน์แรก (คอลัมน์ A) นั้นเต็มไปด้วยชื่อ, และมีอีก Sheet นึงเป็น templete sheet. เราต้องการสร้าง sheet ใหม่ตามจำนวนชื่อในคอลัมน์ A ในชีทแรก และให้ทุกชื่อที่อยู่ภายในคอลัมน์นั้นไปเป็นชื่อของแต่ละ sheet ที่เราสร้าง และ sheet ที่เราสร้างทุกอันจะมีเนื้อความเหมือนกับ template sheet"
</blockquote>
<p>I believe that I might be able to automate this problem.
However, I had no idea how to do it.
Since I don’t know who to ask (I did attempt to ask some of my friends, but they didn’t know either), I started googling.</p>

<p>I came across “Macro” and “Script Editor” function of Google Spreadsheet.
At first, I tried using <code class="language-plaintext highlighter-rouge">Tool &gt; Macro &gt; Record Macro</code> and <code class="language-plaintext highlighter-rouge">Tool &gt; Macro &gt; (The name of my recorded macro)</code>, but no matter how much I tried, it didn’t work as I expected.</p>

<p>So, I resorted to <code class="language-plaintext highlighter-rouge">Tool &gt; Script Editor</code> which I had no idea how to use it.</p>

<p>When I opened the script editor, I found the scripts of my failed recorded macros.</p>

<p>Each macro was written as a function.</p>

<p>I remembered from when I was googling that this was written in <code class="language-plaintext highlighter-rouge">JavaScript</code>. (or “<a href="https://developers.google.com/apps-script" target="_blank" rel="noopener noreferrer">Apps Script</a>” to be more precise.)</p>

<p>I wanted to write a function “AddTemplate()” that iterates through all selected cells, and create a new sheet which its name is the text in the current cell and its content is the same as my template.
As I absolutely had zero experience on JavaScript, I had to keep googling and copy a piece from people’s code on each of everything I want to do.</p>

<p>For instances,</p>
<ol>
  <li>How to iterate through each of the current selected cells? I adapted from <a href="https://stackoverflow.com/questions/50185970/iterate-through-selected-cells-in-google-sheets?fbclid=IwAR0TgOydFPs0jmIxHOb0Kv2ksmBh7McjemM8wwf6Ynlhdsc812Z-RUWtX1Q" target="_blank" rel="noopener noreferrer">this stackoverflow thread</a>.</li>
  <li>How to iterate through every cell in a “range” in google spreadsheet? and what is “range”? I read and adapted from <a href="https://spreadsheet.dev/iterate-through-every-cell-in-range-google-sheets-apps-script?fbclid=IwAR2CL5B8FPzAl2iv_KB997b54YWvto6QBMxku7JoeyqdpYdQS7FlnGl9L04" target="_blank" rel="noopener noreferrer">the documentation apps script itself</a>
</li>
</ol>

<p>My understanding of C++ and Java really helped me understanding these codes (the concept of for-loop, forEach-loop, and Object-Oritented Programming)
However, while I can read the code, I can’t really write one.
And about how to create a new sheet and rename it, I used the piece of code of my failed macro.</p>

<p>After many attempts, lo and behold, it works! The sastification of creating my first script is really satisfying.
Now we have created 17 sheets for each of category. Let’s move on the next part.</p>

<h3 id="the-second-problem">The Second Problem</h3>

<p>Since there is a lot of sheets, it is really difficult to navigate from the main sheet to a specific category’s sheet.</p>

<p>I want to link each cell that contains a category name in the main sheet to its corresponding sheet.
If we do it manually, the process will be like the following:</p>
<ol>
  <li>Click at a cell</li>
  <li>Press ctrl+k</li>
  <li>Click its corresponding sheet.</li>
</ol>

<p>Doing this for 17 times would require 17*3 = 51 clicks(+presses), which is painstaking.</p>

<p>Just kidding! It’s not that much of a work, but I wanted to try automating this process too. So, here we go!</p>

<blockquote>
"You are given a spreadsheet, which contains several sheets inside. In one of the sheets, the cells in the first column contain the names of all other sheets. Link each of these cells to its correspending sheet."
</blockquote>
<blockquote>
[Thai version] "ใน spreadsheet อันหนึ่ง มี sheet หลายอัน โดยมี sheet นึงที่แต่ละ cell ในคอลัมน์แรก (คอลัมน์ A) เต็มไปด้วยชื่อของ sheet อื่น(นอกจาก sheet นี้)ทั้งหมดอยู่ เราอยาก link แต่ละ cell กับ sheet ที่มีชื่อเดียวกับชื่อที่ระบุใน cell นั้น ๆ"
</blockquote>
<p>I wanted to write a function <code class="language-plaintext highlighter-rouge">Linking()</code> that iterates through all selected cells, and link the cell to a sheet with the same name as the content in the cell.</p>

<p>As I still couldn’t write code, I searched for more pieces of the code I needed:</p>
<ol>
  <li>How to add links to a cell in Spreadsheet? I adapted from <a href="https://spreadsheet.dev/iterate-through-every-cell-in-range-google-sheets-apps-script?fbclid=IwAR2CL5B8FPzAl2iv_KB997b54YWvto6QBMxku7JoeyqdpYdQS7FlnGl9L04" target="_blank" rel="noopener noreferrer">this documentation</a>
</li>
  <li>How do I make it link to other sheets? Adapted from little each of these threads
    <ul>
      <li><a href="https://stackoverflow.com/questions/13391768/hyperlink-to-a-specific-sheet?fbclid=IwAR1kPpDGbUCQ1JHkpY7UUdR80dL32Ss3l0HRo6mzStBhvC51j6cEWuhNbWM" target="_blank" rel="noopener noreferrer">Hyperlink to a specific sheet</a></li>
      <li><a href="https://newbedev.com/linking-to-another-tab-in-google-sheets?fbclid=IwAR3c-HjCwTvdlMKngooZLu76LV6xnB2e5V-Isg8-AjUzl5q-eSnOJQEiXeo" target="_blank" rel="noopener noreferrer">Linking to another tab in Google Sheets</a></li>
      <li><a href="https://stackoverflow.com/questions/13605213/iterate-over-range-append-string-to-each?fbclid=IwAR2Qe8JN-C2AC1Cl8K2yBmFTUfw9fUGmgpA4E1BcGEy6Znty_wK7VLpZTkk" target="_blank" rel="noopener noreferrer">Iterate over range, append string to each</a></li>
    </ul>
  </li>
</ol>

<p>This is a more complicated one for sure, as I had to learn how we originally add link to a cell using equal sign <code class="language-plaintext highlighter-rouge">=hyperlink("...")</code>, and how to refer to a string variable in a string(?) <code class="language-plaintext highlighter-rouge">`${variable}`</code>).
It took more time than the first problem, but it works!
It is getting more and more fun.</p>

<p>Now, we have linked the cells to its coresponding sheet. The navigation has become much easier.</p>

<p>Just a little bit more, let’s move on to the final part.</p>

<h3 id="the-final-problem">The Final Problem</h3>

<p>The only tedious thing left to do is to keep track of the total money spending on each of category.</p>

<p>In other words, I want to keep track of the sums of numeric values in “Amount” column of each category.
Doing this manually would be:</p>
<ol>
  <li>Click at a cell on the right of a name cell.</li>
  <li>type <code class="language-plaintext highlighter-rouge">=SUM()</code>
</li>
  <li>Navigate to the name cell’s corresponding sheet</li>
  <li>Select the entire column A</li>
  <li>Press Enter</li>
  <li>Navigate back to the main sheet</li>
</ol>

<blockquote>
You are given a spreadsheet, which contains several sheets inside. In one of the sheets, the cells in the first column contain the names of all other sheets, and they also link to their corresponding sheets. Make the cells to the right of each cell of the first column correspond to the sum of all numberic values in its corresponding sheet's first column (column A).
</blockquote>
<blockquote>
[Thai Version] "ใน spreadsheet อันหนึ่ง มี sheet หลายอัน โดยมี sheet นึงที่แต่ละ cell ในคอลัมน์แรก (คอลัมน์ A) เต็มไปด้วยชื่อของ sheet อื่น(นอกจาก sheet นี้)ทั้งหมดอยู่ และแต่ละ cell ยัง link ไปยัง sheet ที่มีชื่อเดียวกับชื่อที่ระบุใน cell นั้น ๆ อีกด้วย เราอยากทำให้ cell ที่อยู่ทางขวาของแต่ละ cell (cell ในคอลัมน์ B ในแถวเดียวกัน) เป็นผลรวมของเลขในคอลัมน์ที่ A ทั้งคอลัมน์ใน sheet ที่ link กับ cell นั้น"
</blockquote>
<p>Luckily this time, I got almost all the things I need from the previous problems.</p>

<p>This is what I searched for additionally:</p>
<ol>
  <li>How does each function work? What are their inputs? What are their outputs? I looked it up on <a href="https://developers.google.com/apps-script" target="_blank" rel="noopener noreferrer">developers.google.com/apps-script</a>. For example, I want to know what function <code class="language-plaintext highlighter-rouge">getValue()</code> of <code class="language-plaintext highlighter-rouge">sheet</code> object will return, so I searched for <a href="https://developers.google.com/apps-script/reference/spreadsheet/sheet?fbclid=IwAR3zX05fGGYIjTEz6nn7NI_2_p2WrgU0Hf1iUvHSjV5ZHeKaUJchZcFvckY" target="_blank" rel="noopener noreferrer">the documentation of the object</a>
</li>
  <li><a href="https://blog.gsmart.in/google-sheet-script-get-cell-value/" target="_blank" rel="noopener noreferrer">How to get a reference to any cell object, knowing its row and column?</a></li>
</ol>

<p>I did say that I know most of things I need for this problem.
However, this problem takes the longest time to debug out of all three (lmao), by a lot too.</p>

<h2 id="the-final-product">The Final Product</h2>
<p>Here’s the <a href="https://docs.google.com/spreadsheets/d/1GrePsU8OO7W58bBz4W8yKHUcF--LIM4fzk-1DBNcUsM/edit?usp=sharing" target="_blank" rel="noopener noreferrer">link</a> to the finished spreadsheet (the scripts are available in <code class="language-plaintext highlighter-rouge">Tool &gt; Script Editor</code>)</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/Project7_finalproduct-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/Project7_finalproduct-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/Project7_finalproduct-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/Project7_finalproduct.jpg" title="YNAB Spreadsheet">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Screenshot of the final product!
</div>

<p>Thank you for reading!</p>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2022 Tanapoom  Laoaron. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> and <a href="https://github.com/neizod/polar" target="_blank" rel="noopener noreferrer">polar</a> themes. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

